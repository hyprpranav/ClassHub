<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClassHub - Classroom Management</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Universal Hamster Loader (Visible on page load) -->
    <div id="globalLoader" class="loading-overlay">
        <div aria-label="Orange and tan hamster running in a metal wheel" role="img" class="wheel-and-hamster">
            <div class="wheel"></div>
            <div class="hamster">
                <div class="hamster__body">
                    <div class="hamster__head">
                        <div class="hamster__ear"></div>
                        <div class="hamster__eye"></div>
                        <div class="hamster__nose"></div>
                    </div>
                    <div class="hamster__limb hamster__limb--fr"></div>
                    <div class="hamster__limb hamster__limb--fl"></div>
                    <div class="hamster__limb hamster__limb--br"></div>
                    <div class="hamster__limb hamster__limb--bl"></div>
                    <div class="hamster__tail"></div>
                </div>
            </div>
            <div class="spoke"></div>
        </div>
        <div class="loading-text">Loading ClassHub...</div>
    </div>
    
    <!-- OPTIONAL: Light Pillar Animation Background (can be removed) -->
    <div id="lightPillarContainer" class="light-pillar-bg"></div>
    
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="logo-container">
                    <span class="logo-icon">ğŸ“</span>
                    <h1 class="header-title">ClassHub</h1>
                </div>
            </div>
            <div class="header-right">
                <span id="connectionStatus" class="connection-status" title="Working in offline mode"></span>
                <button class="settings-btn" onclick="openSettings()" aria-label="Settings">âš™ï¸</button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="main-container">
        <!-- Card 1: Submission Tracker (Protected) -->
        <div class="card" onclick="requestAccess('tracker')">
            <div class="card-icon">ğŸ“</div>
            <h2 class="card-title">Submission Tracker</h2>
            <p class="card-description">Track student note submissions</p>
        </div>

        <!-- Card 2: Class Drive Hub (Open) -->
        <div class="card" onclick="openDriveHub()">
            <div class="card-icon">ğŸ“‚</div>
            <h2 class="card-title">Class Drive Hub</h2>
            <p class="card-description">Access shared materials</p>
        </div>

        <!-- Card 3: PlaySphere (Open) -->
        <div class="card" onclick="openPlaySphere()">
            <div class="card-icon">ğŸ®</div>
            <h2 class="card-title">PlaySphere</h2>
            <p class="card-description">Gaming platform</p>
        </div>

        <!-- Card 4: Polling & Analysis (Protected) -->
        <div class="card" onclick="requestAccess('polling')">
            <div class="card-icon">ğŸ“Š</div>
            <h2 class="card-title">Polling & Analysis</h2>
            <p class="card-description">Student task polling</p>
        </div>
    </main>

    <!-- Secret Code Modal -->
    <div id="secretModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">ğŸ” Access Protected</h2>
            <p class="modal-subtitle">Enter 6-digit secret code</p>
            <input type="password" id="secretInput" class="secret-input" maxlength="6" placeholder="â€¢ â€¢ â€¢ â€¢ â€¢ â€¢">
            <div class="modal-buttons">
                <button onclick="verifyAccess()" class="btn-primary">Unlock</button>
                <button onclick="closeSecretModal()" class="btn-secondary">Cancel</button>
            </div>
            <p id="secretError" class="error-message"></p>
        </div>
    </div>

    <!-- Submission Tracker View -->
    <div id="trackerView" class="view-container hidden">
        <div class="view-header">
            <button onclick="closeView('tracker')" class="back-btn">â† Back</button>
            <h2>ğŸ“ Submission Tracker</h2>
            <button onclick="showSummary()" class="summary-btn">ğŸ“Š Summary</button>
        </div>

        <!-- Search & Filters -->
        <div class="controls">
            <input type="text" id="searchInput" placeholder="Search by register or name..." class="search-input">
            <div class="filter-group">
                <button onclick="filterGender('all')" class="filter-btn active" data-filter="all">All (62)</button>
                <button onclick="filterGender('male')" class="filter-btn" data-filter="male">Boys (35)</button>
                <button onclick="filterGender('female')" class="filter-btn" data-filter="female">Girls (27)</button>
            </div>
            <div class="filter-group">
                <button onclick="filterSubmission('all')" class="filter-btn active" data-submission="all">All</button>
                <button onclick="filterSubmission('submitted')" class="filter-btn" data-submission="submitted">Submitted</button>
                <button onclick="filterSubmission('pending')" class="filter-btn" data-submission="pending">Pending</button>
            </div>
            <div class="sort-group">
                <label>Sort by:</label>
                <select id="sortSelect" onchange="sortStudents()" class="sort-select">
                    <option value="register">Register Number</option>
                    <option value="name">Name</option>
                    <option value="time">Submission Time</option>
                </select>
            </div>
        </div>

        <!-- Student List -->
        <div id="studentList" class="student-list"></div>
    </div>

    <!-- Drive Hub View -->
    <div id="driveView" class="view-container hidden">
        <div class="view-header">
            <button onclick="closeView('drive')" class="back-btn">â† Back</button>
            <h2>ğŸ“‚ Class Drive Hub</h2>
        </div>
        <div class="drive-links">
            <div class="drive-card" onclick="openLink('staff')">
                <div class="drive-icon">ğŸ‘¨â€ğŸ«</div>
                <h3>Staff Materials</h3>
                <p>Lecture notes and resources</p>
            </div>
            <div class="drive-card" onclick="openLink('student')">
                <div class="drive-icon">ğŸ“š</div>
                <h3>Student Materials</h3>
                <p>Assignments and guides</p>
            </div>
            <div class="drive-card" onclick="openLink('photos')">
                <div class="drive-icon">ğŸ“·</div>
                <h3>Photos & Events</h3>
                <p>Class memories</p>
            </div>
        </div>
    </div>

    <!-- Polling View -->
    <div id="pollingView" class="view-container hidden">
        <div class="view-header">
            <button onclick="closeView('polling')" class="back-btn">â† Back</button>
            <h2>ğŸ“Š Polling & Analysis</h2>
        </div>

        <!-- Poll Creation -->
        <div class="poll-section">
            <h3>Create Poll</h3>
            <input type="text" id="pollQuestion" placeholder="Enter poll question..." class="poll-input">
            <button onclick="createPoll()" class="btn-primary">Create Poll</button>
        </div>

        <!-- Active Polls -->
        <div id="activePollsList" class="polls-list"></div>

        <!-- Analytics -->
        <div class="analytics-section">
            <h3>ğŸ“ˆ Analytics</h3>
            <div id="analyticsData" class="analytics-data"></div>
        </div>
    </div>

    <!-- Summary Modal -->
    <div id="summaryModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">ğŸ“Š Submission Summary</h2>
            <div id="summaryContent" class="summary-content"></div>
            <button onclick="closeSummary()" class="btn-primary">Close</button>
        </div>
    </div>

    <!-- Settings Panel -->
    <div id="settingsPanel" class="settings-panel">
        <div class="settings-content">
            <div class="settings-header">
                <h2>âš™ï¸ Settings</h2>
                <button onclick="closeSettings()" class="close-btn">âœ•</button>
            </div>
            
            <div class="setting-item">
                <label>ğŸŒ“ Theme</label>
                <div class="theme-toggle">
                    <button onclick="setTheme('light')" class="theme-btn active" data-theme="light">â˜€ï¸ Light</button>
                    <button onclick="setTheme('dark')" class="theme-btn" data-theme="dark">ğŸŒ™ Dark</button>
                </div>
            </div>

            <div class="setting-item">
                <label>ğŸ“ Font Size</label>
                <div class="font-size-control">
                    <button onclick="adjustFontSize(-1)">A-</button>
                    <span id="fontSizeDisplay">Medium</span>
                    <button onclick="adjustFontSize(1)">A+</button>
                </div>
            </div>

            <div class="setting-item">
                <label>ğŸ”„ Auto-Reset (24 hours)</label>
                <label class="switch">
                    <input type="checkbox" id="autoResetToggle" onchange="toggleAutoReset()">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <button onclick="confirmReset()" class="btn-danger">ğŸ—‘ï¸ Reset All Data</button>
            </div>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="resetModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">âš ï¸ Confirm Reset</h2>
            <p>This will delete all submission and poll data. Continue?</p>
            <div class="modal-buttons">
                <button onclick="resetData()" class="btn-danger">Reset</button>
                <button onclick="closeResetModal()" class="btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p class="copyright">Â© 2026 ClassHub. All rights reserved.</p>
            <p class="credits">Crafted by Harish Pranav S</p>
        </div>
    </footer>

    <!-- Firebase & JavaScript -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- OPTIONAL: Three.js for Light Pillar Animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Hamster Loader (Universal Loading Animation) -->
    <script src="js/hamster-loader.js"></script>
    
    <script src="js/auth.js"></script>
    <script src="js/firebase.js"></script>
    <script src="js/students.js"></script>
    <script src="js/tracker.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/poll.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/animations.js"></script>
    
    <!-- OPTIONAL: Light Pillar Animation (Delete this line + js/lightpillar.js to remove animation) -->
    <script src="js/lightpillar.js"></script>
</body>
</html>
